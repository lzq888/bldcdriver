EESchema Schematic File Version 2  date Fri 01 May 2015 21:46:15 MST
LIBS:power
LIBS:device
LIBS:transistors
LIBS:conn
LIBS:linear
LIBS:regul
LIBS:74xx
LIBS:cmos4000
LIBS:adc-dac
LIBS:memory
LIBS:xilinx
LIBS:special
LIBS:microcontrollers
LIBS:dsp
LIBS:microchip
LIBS:analog_switches
LIBS:motorola
LIBS:texas
LIBS:intel
LIBS:audio
LIBS:interface
LIBS:digital-audio
LIBS:philips
LIBS:display
LIBS:cypress
LIBS:siliconi
LIBS:opto
LIBS:atmel
LIBS:contrib
LIBS:valves
LIBS:bldc-cache
LIBS:bldc-cache
EELAYER 25  0
EELAYER END
$Descr User 11000 8500
encoding utf-8
Sheet 3 4
Title "Microcontroller and Support"
Date "2 may 2015"
Rev ""
Comp ""
Comment1 ""
Comment2 ""
Comment3 ""
Comment4 ""
$EndDescr
$Comp
L ATMEGA328-A U3
U 1 1 554452A4
P 3350 2900
F 0 "U3" H 2650 4150 50  0000 L BNN
F 1 "ATMEGA328-A" H 3600 1500 50  0000 L BNN
F 2 "TQFP32" H 2800 1550 50  0001 C CNN
	1    3350 2900
	1    0    0    -1  
$EndComp
Wire Wire Line
	3725 6500 3450 6500
Wire Wire Line
	3725 6700 3450 6700
Wire Wire Line
	3975 6600 4300 6600
Connection ~ 6250 2500
Wire Wire Line
	6250 2500 6300 2500
Wire Wire Line
	4350 2500 5400 2500
Wire Wire Line
	5400 2500 5400 2750
Wire Wire Line
	5400 2750 5750 2750
Wire Wire Line
	2450 3250 2300 3250
Wire Wire Line
	4350 4100 4500 4100
Wire Wire Line
	4350 1800 4500 1800
Wire Wire Line
	4350 2200 4500 2200
Wire Wire Line
	4350 3500 4500 3500
Connection ~ 2350 1900
Wire Wire Line
	2350 2000 1900 2000
Wire Wire Line
	2350 2000 2350 1800
Wire Wire Line
	1600 2100 2450 2100
Connection ~ 1800 2100
Connection ~ 1950 2100
Wire Wire Line
	6950 5200 6950 5150
Wire Wire Line
	7050 5050 6950 5050
Wire Wire Line
	3350 6800 3450 6800
Wire Wire Line
	2950 6400 2850 6400
Wire Wire Line
	3450 6800 3450 6700
Wire Wire Line
	4300 6800 4300 6700
Wire Wire Line
	4300 6400 4300 6500
Wire Wire Line
	3450 6500 3450 6400
Wire Wire Line
	4800 6600 4900 6600
Wire Wire Line
	2950 6600 2850 6600
Wire Wire Line
	9250 2750 9500 2750
Wire Wire Line
	9500 2750 9500 2700
Wire Wire Line
	9250 1750 9250 1700
Wire Wire Line
	9250 3150 9250 3200
Wire Wire Line
	8450 2950 8300 2950
Wire Wire Line
	9500 2300 9500 2250
Wire Wire Line
	9500 2250 9050 2250
Connection ~ 9250 2250
Wire Wire Line
	1950 2500 1950 2550
Wire Wire Line
	4350 2000 4500 2000
Wire Wire Line
	4350 2750 4500 2750
Connection ~ 2400 4100
Wire Wire Line
	2300 2800 2300 2850
Connection ~ 1900 1500
Wire Wire Line
	1900 2000 1900 1450
Wire Wire Line
	4350 3900 4500 3900
Wire Wire Line
	4350 3600 4500 3600
Wire Wire Line
	4350 3800 4500 3800
Wire Wire Line
	4350 1900 4500 1900
Wire Wire Line
	4350 3700 4500 3700
Wire Wire Line
	4350 4000 4500 4000
Wire Wire Line
	4350 2950 4500 2950
Wire Wire Line
	2450 2400 2300 2400
Wire Wire Line
	2400 4000 2450 4000
Wire Wire Line
	2450 4100 2400 4100
Wire Wire Line
	4350 2650 4500 2650
Wire Wire Line
	4350 2850 4500 2850
Wire Wire Line
	4350 3050 4500 3050
Wire Wire Line
	2050 1500 1600 1500
Wire Wire Line
	4350 3250 5300 3250
Connection ~ 5150 3250
Wire Wire Line
	6950 5150 7050 5150
Wire Wire Line
	7050 4950 6950 4950
Wire Wire Line
	1800 2050 1800 2100
Wire Wire Line
	2350 1800 2450 1800
Wire Wire Line
	2450 1900 2350 1900
Wire Wire Line
	2450 3900 2400 3900
Wire Wire Line
	2400 3900 2400 4150
Connection ~ 2400 4000
Wire Wire Line
	4350 3400 4500 3400
Wire Wire Line
	4350 2100 4500 2100
Wire Wire Line
	4350 2300 4500 2300
Wire Wire Line
	4350 3150 4500 3150
Wire Wire Line
	2450 3150 2300 3150
Wire Wire Line
	4350 2400 5400 2400
Wire Wire Line
	5400 2400 5400 2150
Wire Wire Line
	5400 2150 5750 2150
Wire Wire Line
	6150 2750 6250 2750
Wire Wire Line
	6250 2750 6250 2150
Wire Wire Line
	6250 2150 6150 2150
Wire Wire Line
	4300 6500 3975 6500
Wire Wire Line
	4300 6700 3975 6700
Wire Wire Line
	3725 6600 3450 6600
$Comp
L GND #PWR016
U 1 1 554450AC
P 6300 2500
F 0 "#PWR016" H 6300 2500 30  0001 C CNN
F 1 "GND" H 6300 2430 30  0001 C CNN
	1    6300 2500
	0    -1   -1   0   
$EndComp
$Comp
L C C12
U 1 1 554450A4
P 5950 2150
F 0 "C12" H 6000 2250 50  0000 L CNN
F 1 "18pF" H 6000 2050 50  0000 L CNN
F 2 "0805" H 5950 2150 60  0001 C CNN
F 4 "CL21C180JBANNNC" H 5950 2150 60  0001 C CNN "Mfg P/N"
F 5 "1276-1107-1-ND" H 5950 2150 60  0001 C CNN "Digikey P/N"
	1    5950 2150
	0    -1   -1   0   
$EndComp
$Comp
L C C13
U 1 1 55445018
P 5950 2750
F 0 "C13" H 6000 2850 50  0000 L CNN
F 1 "18pF" H 6000 2650 50  0000 L CNN
F 2 "0805" H 5950 2750 60  0001 C CNN
F 4 "CL21C180JBANNNC" H 5950 2750 60  0001 C CNN "Mfg P/N"
F 5 "1276-1107-1-ND" H 5950 2750 60  0001 C CNN "Digikey P/N"
	1    5950 2750
	0    1    1    0   
$EndComp
$Comp
L CRYSTAL X1
U 1 1 55444EB1
P 5750 2450
F 0 "X1" H 5750 2600 60  0000 C CNN
F 1 "20MHz" H 5750 2300 60  0000 C CNN
F 2 "HC49" H 5750 2450 60  0001 C CNN
F 3 "datasheets/9b-20.pdf" H 5750 2450 60  0001 C CNN
F 4 "9B-20.000MBBK-B" H 5750 2450 60  0001 C CNN "Mfg P/N"
F 5 "887-2018-ND" H 5750 2450 60  0001 C CNN "Digikey P/N"
F 6 "9B-20.000MEEJ-B" H 5750 2450 60  0001 C CNN "Mouser P/N"
	1    5750 2450
	0    -1   -1   0   
$EndComp
NoConn ~ 2300 3150
NoConn ~ 2300 3250
NoConn ~ 4500 4100
NoConn ~ 4500 3150
NoConn ~ 4500 1800
Text Label 4500 2300 0    40   ~ 0
SCK
Text Label 4500 2200 0    40   ~ 0
MISO
Text Label 4500 2100 0    40   ~ 0
MOSI
Text Label 4500 3500 0    40   ~ 0
UART_TX
Text Label 4500 3400 0    40   ~ 0
UART_RX
$Comp
L JUMPER JP1
U 1 1 553C353B
P 4300 6100
F 0 "JP1" H 4300 6250 60  0000 C CNN
F 1 "JUMPER" H 4300 6020 40  0000 C CNN
	1    4300 6100
	0    1    1    0   
$EndComp
$Comp
L R R13
U 1 1 5533F767
P 8700 2950
F 0 "R13" V 8780 2950 50  0000 C CNN
F 1 "1K" V 8700 2950 50  0000 C CNN
F 2 "0805" H 8700 2950 60  0001 C CNN
F 4 "ERJ-6ENF1001V" V 8700 2950 60  0001 C CNN "Mfg P/N"
F 5 "P1.00KCCT-ND" V 8700 2950 60  0001 C CNN "Digikey P/N"
F 6 "667-ERJ-6ENF1001V" V 8700 2950 60  0001 C CNN "Mouser P/N"
	1    8700 2950
	0    1    1    0   
$EndComp
$Comp
L NPN Q1
U 1 1 5533F768
P 9150 2950
F 0 "Q1" H 9150 2800 50  0000 R CNN
F 1 "2N3904" H 9150 3100 50  0000 R CNN
F 2 "TO-92-3" H 9150 2950 60  0001 C CNN
F 4 "2N3904BU" H 9150 2950 60  0001 C CNN "Mfg P/N"
F 5 "2N3904FS-ND" H 9150 2950 60  0001 C CNN "Digikey P/N"
F 6 "512-2N3904BU" H 9150 2950 60  0001 C CNN "Mouser P/N"
	1    9150 2950
	1    0    0    -1  
$EndComp
$Comp
L R R14
U 1 1 553C29EF
P 9250 2000
F 0 "R14" V 9330 2000 50  0000 C CNN
F 1 "57.6K" V 9250 2000 50  0000 C CNN
F 2 "0805" H 9250 2000 60  0001 C CNN
F 4 "ERJ-6ENF5622V" V 9250 2000 60  0001 C CNN "Mfg P/N"
F 5 "P56.2KCCT-ND" V 9250 2000 60  0001 C CNN "Digikey P/N"
F 6 "667-ERJ-6ENF5622V" V 9250 2000 60  0001 C CNN "Mouser P/N"
	1    9250 2000
	-1   0    0    -1  
$EndComp
$Comp
L R R11
U 1 1 553C28C3
P 4550 6600
F 0 "R11" V 4630 6600 50  0000 C CNN
F 1 "10.2K" V 4550 6600 50  0000 C CNN
F 2 "0805" H 4550 6600 60  0001 C CNN
F 4 "ERJ-6ENF1022V" V 4550 6600 60  0001 C CNN "Mfg P/N"
F 5 "P10.2KCCT-ND" V 4550 6600 60  0001 C CNN "Digikey P/N"
F 6 "667-ERJ-6ENF1022V" V 4550 6600 60  0001 C CNN "Mouser P/N"
	1    4550 6600
	0    1    1    0   
$EndComp
$Comp
L R R10
U 1 1 553C28BE
P 3200 6600
F 0 "R10" V 3280 6600 50  0000 C CNN
F 1 "10.2K" V 3200 6600 50  0000 C CNN
F 2 "0805" H 3200 6600 60  0001 C CNN
F 4 "ERJ-6ENF1022V" V 3200 6600 60  0001 C CNN "Mfg P/N"
F 5 "P10.2KCCT-ND" V 3200 6600 60  0001 C CNN "Digikey P/N"
F 6 "667-ERJ-6ENF1022V" V 3200 6600 60  0001 C CNN "Mouser P/N"
	1    3200 6600
	0    1    1    0   
$EndComp
$Comp
L R R9
U 1 1 553C28B9
P 3200 6400
F 0 "R9" V 3280 6400 50  0000 C CNN
F 1 "10.2K" V 3200 6400 50  0000 C CNN
F 2 "0805" H 3200 6400 60  0001 C CNN
F 4 "ERJ-6ENF1022V" V 3200 6400 60  0001 C CNN "Mfg P/N"
F 5 "P10.2KCCT-ND" V 3200 6400 60  0001 C CNN "Digikey P/N"
F 6 "667-ERJ-6ENF1022V" V 3200 6400 60  0001 C CNN "Mouser P/N"
	1    3200 6400
	0    1    1    0   
$EndComp
$Comp
L R R15
U 1 1 553C28A7
P 9250 2500
F 0 "R15" V 9330 2500 50  0000 C CNN
F 1 "10.2K" V 9250 2500 50  0000 C CNN
F 2 "0805" H 9250 2500 60  0001 C CNN
F 4 "ERJ-6ENF1022V" V 9250 2500 60  0001 C CNN "Mfg P/N"
F 5 "P10.2KCCT-ND" V 9250 2500 60  0001 C CNN "Digikey P/N"
F 6 "667-ERJ-6ENF1022V" V 9250 2500 60  0001 C CNN "Mouser P/N"
	1    9250 2500
	-1   0    0    1   
$EndComp
$Comp
L C C14
U 1 1 553C2455
P 9500 2500
F 0 "C14" H 9550 2600 50  0000 L CNN
F 1 "1000pF" H 9550 2400 50  0000 L CNN
F 2 "0805" H 9500 2500 60  0001 C CNN
F 4 "CL21B102KBANNNC" H 9500 2500 60  0001 C CNN "Mfg P/N"
F 5 "1276-1020-1-ND" H 9500 2500 60  0001 C CNN "Digikey P/N"
	1    9500 2500
	1    0    0    -1  
$EndComp
$Comp
L C C11
U 1 1 553C244A
P 5150 3450
F 0 "C11" H 5200 3550 50  0000 L CNN
F 1 "1000pF" H 5200 3350 50  0000 L CNN
F 2 "0805" H 5150 3450 60  0001 C CNN
F 4 "CL21B102KBANNNC" H 5150 3450 60  0001 C CNN "Mfg P/N"
F 5 "1276-1020-1-ND" H 5150 3450 60  0001 C CNN "Digikey P/N"
	1    5150 3450
	1    0    0    -1  
$EndComp
$Comp
L C C10
U 1 1 553C232C
P 2300 2600
F 0 "C10" H 2350 2700 50  0000 L CNN
F 1 "1uF" H 2350 2500 50  0000 L CNN
F 2 "0805" H 2300 2600 60  0001 C CNN
F 4 "CL21F105ZBFNNNE" H 2300 2600 60  0001 C CNN "Mfg P/N"
F 5 "1276-3010-1-ND" H 2300 2600 60  0001 C CNN "Digikey P/N"
	1    2300 2600
	1    0    0    -1  
$EndComp
$Comp
L C C8
U 1 1 553C2329
P 1950 2300
F 0 "C8" H 2000 2400 50  0000 L CNN
F 1 "1uF" H 2000 2200 50  0000 L CNN
F 2 "0805" H 1950 2300 60  0001 C CNN
F 4 "CL21F105ZBFNNNE" H 1950 2300 60  0001 C CNN "Mfg P/N"
F 5 "1276-3010-1-ND" H 1950 2300 60  0001 C CNN "Digikey P/N"
	1    1950 2300
	1    0    0    -1  
$EndComp
$Comp
L C C9
U 1 1 553C2323
P 2050 1700
F 0 "C9" H 2100 1800 50  0000 L CNN
F 1 "1uF" H 2100 1600 50  0000 L CNN
F 2 "0805" H 2050 1700 60  0001 C CNN
F 4 "CL21F105ZBFNNNE" H 2050 1700 60  0001 C CNN "Mfg P/N"
F 5 "1276-3010-1-ND" H 2050 1700 60  0001 C CNN "Digikey P/N"
	1    2050 1700
	1    0    0    -1  
$EndComp
$Comp
L +5VA #PWR017
U 1 1 553437E9
P 1800 2050
F 0 "#PWR017" H 1800 2180 20  0001 C CNN
F 1 "+5VA" H 1800 2150 30  0000 C CNN
	1    1800 2050
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR018
U 1 1 553400C3
P 6950 5200
F 0 "#PWR018" H 6950 5200 30  0001 C CNN
F 1 "GND" H 6950 5130 30  0001 C CNN
	1    6950 5200
	1    0    0    -1  
$EndComp
Text Label 6950 5050 2    40   ~ 0
UART_RX
Text Label 6950 4950 2    40   ~ 0
UART_TX
$Comp
L CONN_3 J5
U 1 1 553400A6
P 7400 5050
F 0 "J5" V 7350 5050 50  0000 C CNN
F 1 "SERIAL_OUT" V 7450 5050 40  0000 C CNN
F 2 "3x1 0.1\"" H 7400 5050 60  0001 C CNN
F 4 "PREC040SAAN-RC" V 7400 5050 60  0001 C CNN "Mfg P/N"
F 5 "S1012EC-40-ND" V 7400 5050 60  0001 C CNN "Digikey P/N"
	1    7400 5050
	1    0    0    -1  
$EndComp
$Comp
L AVR-ISP-6 J4
U 1 1 5533F784
P 3850 6600
F 0 "J4" H 3700 6850 50  0000 C CNN
F 1 "ICSP" H 3600 6325 50  0000 L BNN
F 2 "3x2 0.1\"" V 3350 6600 50  0001 C CNN
F 4 "30306-6002HB" H 3850 6600 60  0001 C CNN "Mfg P/N"
F 5 "3M15451-ND" H 3850 6600 60  0001 C CNN "Digikey P/N"
F 6 "517-30306-6002HB" H 3850 6600 60  0001 C CNN "Mouser P/N"
	1    3850 6600
	1    0    0    -1  
$EndComp
Text Label 4900 6600 0    40   ~ 0
MOSI
Text Label 2850 6400 2    40   ~ 0
MISO
Text Label 2850 6600 2    40   ~ 0
SCK
Text Label 3350 6800 2    40   ~ 0
nRESET
$Comp
L +5V #PWR019
U 1 1 5533F780
P 4300 5800
F 0 "#PWR019" H 4300 5890 20  0001 C CNN
F 1 "+5V" H 4300 5890 30  0000 C CNN
	1    4300 5800
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR020
U 1 1 5533F77F
P 4300 6800
F 0 "#PWR020" H 4300 6800 30  0001 C CNN
F 1 "GND" H 4300 6730 30  0001 C CNN
	1    4300 6800
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR021
U 1 1 5533F766
P 9250 3200
F 0 "#PWR021" H 9250 3200 30  0001 C CNN
F 1 "GND" H 9250 3130 30  0001 C CNN
	1    9250 3200
	1    0    0    -1  
$EndComp
$Comp
L +BATT #PWR022
U 1 1 5533F765
P 9250 1700
F 0 "#PWR022" H 9250 1650 20  0001 C CNN
F 1 "+BATT" H 9250 1800 30  0000 C CNN
	1    9250 1700
	1    0    0    -1  
$EndComp
Text Label 9050 2250 2    40   ~ 0
BATT_SENSE
Text Label 8300 2950 2    40   ~ 0
BATT_PWM
Text Label 5300 3250 0    40   ~ 0
nRESET
Text HLabel 4500 2950 2    40   Input ~ 0
CURR_SENSE
Text HLabel 4500 2850 2    40   Input ~ 0
W_BEMF_SENSE
Text HLabel 4500 2750 2    40   Input ~ 0
V_BEMF_SENSE
Text HLabel 4500 2650 2    40   Input ~ 0
U_BEMF_SENSE
Text HLabel 4500 4000 2    40   Output ~ 0
U_HI
Text HLabel 4500 3900 2    40   Output ~ 0
V_HI
Text HLabel 4500 3600 2    40   Output ~ 0
U_LO
Text HLabel 4500 3700 2    40   Output ~ 0
V_LO
Text HLabel 4500 3800 2    40   Output ~ 0
W_LO
Text HLabel 4500 1900 2    40   Output ~ 0
W_HI
$Comp
L INDUCTOR L1
U 1 1 5533F45C
P 1600 1800
F 0 "L1" V 1550 1800 40  0000 C CNN
F 1 "1k @ 100MHz" V 1700 1800 40  0000 C CNN
F 2 "0805" H 1600 1800 60  0001 C CNN
F 4 "BK2125HS102-T" V 1600 1800 60  0001 C CNN "Mfg P/N"
F 5 "587-1904-1-ND" V 1600 1800 60  0001 C CNN "Digikey P/N"
F 6 "963-BK2125HS102-T" V 1600 1800 60  0001 C CNN "Mouser P/N"
	1    1600 1800
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR023
U 1 1 5533F45A
P 2400 4150
F 0 "#PWR023" H 2400 4150 30  0001 C CNN
F 1 "GND" H 2400 4080 30  0001 C CNN
	1    2400 4150
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR024
U 1 1 5533F459
P 2300 2850
F 0 "#PWR024" H 2300 2850 30  0001 C CNN
F 1 "GND" H 2300 2780 30  0001 C CNN
	1    2300 2850
	1    0    0    -1  
$EndComp
$Comp
L +5V #PWR025
U 1 1 5533F458
P 1900 1450
F 0 "#PWR025" H 1900 1540 20  0001 C CNN
F 1 "+5V" H 1900 1540 30  0000 C CNN
	1    1900 1450
	1    0    0    -1  
$EndComp
Text Label 4500 3050 0    40   ~ 0
BATT_SENSE
Text Label 4500 2000 0    40   ~ 0
BATT_PWM
$Comp
L GND #PWR026
U 1 1 5533F455
P 1950 2550
F 0 "#PWR026" H 1950 2550 30  0001 C CNN
F 1 "GND" H 1950 2480 30  0001 C CNN
	1    1950 2550
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR027
U 1 1 5533F454
P 2050 1900
F 0 "#PWR027" H 2050 1900 30  0001 C CNN
F 1 "GND" H 2050 1830 30  0001 C CNN
	1    2050 1900
	1    0    0    -1  
$EndComp
$Comp
L R R12
U 1 1 5533F453
P 5150 3000
F 0 "R12" V 5230 3000 50  0000 C CNN
F 1 "10.2K" V 5150 3000 50  0000 C CNN
F 2 "0805" H 5150 3000 60  0001 C CNN
F 4 "ERJ-6ENF1022V" V 5150 3000 60  0001 C CNN "Mfg P/N"
F 5 "P10.2KCCT-ND" V 5150 3000 60  0001 C CNN "Digikey P/N"
F 6 "667-ERJ-6ENF1022V" V 5150 3000 60  0001 C CNN "Mouser P/N"
	1    5150 3000
	-1   0    0    1   
$EndComp
$Comp
L +5V #PWR028
U 1 1 5533F451
P 5150 2750
F 0 "#PWR028" H 5150 2840 20  0001 C CNN
F 1 "+5V" H 5150 2840 30  0000 C CNN
	1    5150 2750
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR029
U 1 1 5533F450
P 5150 3650
F 0 "#PWR029" H 5150 3650 30  0001 C CNN
F 1 "GND" H 5150 3580 30  0001 C CNN
	1    5150 3650
	1    0    0    -1  
$EndComp
$EndSCHEMATC
